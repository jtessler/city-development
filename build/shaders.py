#!/usr/bin/env python

"""Produces JavaScript from all shaders in glsl/"""

import re
import os

print "/* THIS FILE IS AUTOMATICALLY GENERATED */\n"
print "goog.provide('cidev.webgl.shader.glsl');"

def isShader(filename):
  return filename.endswith(".glsl") \
      or filename.endswith(".vert") \
      or filename.endswith(".frag")

for filename in filter(isShader, os.listdir("glsl/")):
  shader = open("glsl/" + filename, "r")
  print "\n/** @type {string} */"
  # Escape all newlines and quotes for JavaScript-safe code.
  print "cidev.webgl.shader.glsl['%s'] = '%s';" % (filename,
      re.sub(r"(\n)", r"\\n", re.sub(r"([\',\"])", r"\\\1", shader.read())))
  shader.close()
